# This config uses industrial_ci (https://github.com/ros-industrial/industrial_ci.git).
# For troubleshooting, see readme (https://github.com/ros-industrial/industrial_ci/blob/master/README.rst)

name: Humble - pre-release

on:
  workflow_dispatch:
    inputs:
      downstream_depth:
        description: 'The depth of the depends-on tree to be included in the overlay workspace (-1 implies unlimited, default: 0)'
        required: false
        default: '0'
        type: string
  pull_request:
    branches:
      - humble
    types:
      - opened # default
      - reopened # default
      - synchronize # default
      - labeled # also if a label changes
env:
  # downstream_depth is not set on pull_request event
  PRERELEASE_DEPTH: ${{ inputs.downstream_depth || '0'}}

jobs:
  default:
    uses: ros-controls/ros2_control_ci/.github/workflows/reusable-prerelease.yml@reusable_prerelease
    with:
      ros_distro: humble
      prerelease_downstream_depth: ${{ github.env.PRERELEASE_DEPTH }}
